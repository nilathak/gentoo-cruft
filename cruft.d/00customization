#!/usr/bin/env bash

# on every host, identical
# FIXME implement automatic check/sync, version control handled by backup anyway
# ==============================================
echo ^/etc/conf\\.d/consolefont$
echo ^/etc/conf\\.d/keymaps$
# FIXME new dhcpcd version does not push hostname by default
echo ^/etc/dhcpcd\\.conf$
# generated by eselect locale, but manually modified for mixed language setup
echo ^/etc/env\\.d/02locale$ 
echo ^/etc/locale\\.gen$
echo ^/etc/mail/aliases$
echo ^/etc/rc\\.conf$
echo ^/root/\\.gitconfig$
echo ^/root/\\.ssh/authorized_keys$
echo ^/usr/bin/admin\\.py$
echo ^/usr/bin/backup\\.py$

# FIXME cruft/pylon repo
echo ^/usr/bin/\\.git$
cd /usr/bin && git ls-files | sed 's/\(.*\)/\/usr\/bin\/\1/' | sed 's/[^\/]*\(\/.*\)/\1/' | sed 's/\(\/.*\)/\1/' | sed 's/\+/\\+/g' | sed 's/\./\\./g' | sed 's/\(.*\)/^\1$/'
echo ^/usr/bin/pylon/__pycache__$
echo ^/usr/bin/pylon/gentoo/__pycache__$

# on every host, different
# ==============================================
echo ^/etc/conf\\.d/hostname$
echo ^/etc/conf\\.d/net$
echo ^/etc/cron\\.monthly/report$
echo ^/etc/default/grub$
echo ^/etc/fstab$
echo ^/etc/portage/make\\.conf$
echo ^/etc/portage/package\\.accept_keywords/all$
echo ^/etc/portage/package\\.mask/all$
echo ^/etc/portage/package\\.nowarn/all$
echo ^/etc/portage/package\\.unmask/all$
echo ^/etc/portage/package\\.use/all$
echo ^/etc/portage/repos\\.conf/eselect-repo\\.conf$
echo ^/etc/smartd\\.conf$
echo ^/var/lib/portage/world$

# host specific
# ==============================================
case $HOSTNAME in
    diablo)
        # FIXME needed to fix git commit pinentry for root
        echo ^/etc/bash/bashrc\\.d/99-gpg-tty\\.bash$
        echo ^/etc/conf\\.d/apache2$
        echo ^/etc/conf\\.d/bluetooth$
        echo ^/etc/conf\\.d/display-manager$
        echo ^/etc/cron\\.daily/backup$
        echo ^/etc/cron\\.hourly/backup$
        echo ^/etc/portage/package\\.accept_keywords/kde-.*$
        echo ^/etc/portage/package\\.nowarn/kde$
        # FIXME maybe baal needs a custom version as well with only compatibility_level???
        echo ^/etc/postfix/main\\.cf$ 
        echo ^/etc/sysctl\\.d/syncthing\\.conf$
        echo ^/usr/bin/games\\.py$
        echo ^/var/db/repos/fork$

        # FIXME Web applications and data
        # As per GLEP 11: http://www.gentoo.org/proj/en/glep/glep-0011.html
        # Would like to make this more accurate.
        # Hopefully Gentoo will change to /srv/www someday to comply with FHS 2.3.
        echo ^/var/www$
         
        # FIXME ignore MD5 mismatch in texlive files
        echo ^/var/lib/texmf/web2c/.*\\.fmt$
        echo ^/var/lib/texmf/web2c/.*\\.log$
        ;;
    
    baal)
        echo ^/etc/conf\\.d/hostapd$
        echo ^/etc/dnsmasq\\.conf$
        echo ^/etc/hostapd/hostapd\\.conf$
        echo ^/etc/hosts$
        echo ^/etc/inittab$
        echo ^/etc/resolv\\.conf\\.head$
        echo ^/etc/sysctl\\.d/ip_forwarding\\.conf$
        ;;

    *)
        ;;
esac
